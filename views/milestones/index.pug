extend ../layout

block content
    .container-fluid 
        .row
            .col-1.mt-4  
            .col-10.mt-4 
                .row.mb-4.align-items-center 
                    .col-8 
                        h1
                            a(href=`/projects/${project.id}`)= project.name
                            span.gray  / Milestones
                    .col-4.text-end 
                        if permissions && permissions.milestones && permissions.milestones.create
                            a(href=`/projects/${project.id}/milestones/new`).btn New milestone

                include ../includes/flash

                table.mb-0 
                    thead 
                        tr.antiqueWhite 
                            th ID
                            th Name 
                            th Due date
                            th Progress
                    tbody
                        if milestones.length > 0
                            each milestone in milestones
                                tr
                                    td= milestone.id
                                    td 
                                        a(href=`/projects/${project.id}/milestones/${milestone.id}`)= milestone.name
                                    td= milestone.dueDate || 'N/A'
                                    td
                                        .mb-2
                                            strong #{milestone.progress}%
                                            span.gray.ml-2 (#{milestone.completedWork}/#{milestone.totalWork} work items)
                                        .progress-bar(style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px;")
                                            .progress-fill(style=`width: ${milestone.progress}%; height: 100%; background: ${milestone.progress === 100 ? '#28a745' : '#007bff'}; border-radius: 4px;`)
                        else
                            tr
                                td(colspan="4").text-center.gray No milestones found.
            .col-1.mt-4
